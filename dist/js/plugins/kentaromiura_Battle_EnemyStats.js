/*:
 * @plugindesc Display HP of enemies
 * @author Cristian Carlesso <kentaromiura>
 * @param showHPBar
 * @desc if true shows the hp bar
 * @default true
 * @param animate
 * @desc if true animates the hp bar
 * @default true
 * @param maxAnimationHeight
 * @desc the amount of pixel the bar will move upwards
 * @default 40
 * @param showHP
 * @desc if true show the HP
 * @default true
 * @param padding
 * @desc the distance between the sprite and the bar
 * @default 20
 */
(function(c,d){var a={},b=function(f){var e=a[f];if(!e){e=a[f]={};var g=e.exports={};c[f].call(g,b,e,g,d)}return e.exports};b('0')}({'0':function(d,s,r,g){var c=d('1');var l=d('2');var m=d('3');var o=d('4');var a=o();function q(a){return SceneManager._scene._spriteset._battleField.children.filter(function(b){return b._enemy===a})[0]}function p(){BattleManager.processDefeat=c(BattleManager.processDefeat,'afterDefeat');var a=['battleStarted','battleWon','battleEscaped'];;['onBattleStart','onBattleWin','onBattleEscape'].forEach(function(b,d){$gameSystem[b]=c($gameSystem[b],a[d])})}DataManager.createGameObjects=c(DataManager.createGameObjects,'gameObjectsCreated');var k=l([{x:0,y:.89},{x:.15,y:-.3},{x:.25,y:.02},{x:.52,y:.26},{x:.8,y:.02},{x:.85,y:-.31},{x:1,y:.88}],1e-4),e=0,h=a.maxAnimationHeight-0,b=32,f=a.padding-0,j=function(a){e=h*a},n=new m(2e3,k,j),i=function(){p();if(a.animate==='true'){n.loop()}var c=false,d=function(){$gameTroop.members().forEach(function(c){c._height=c._height||(c._height=q(c).height);var d=c._hpSprite||(c._hpSprite=new Sprite_Base);var g=c._hpBar||(c._hpBar=new Sprite_Base);var i=''+c._hp;var m=c._maxHP||(c._maxHP=$dataEnemies[c._enemyId].params[0]);var k=i.length*b;d.bitmap=new Bitmap(k,b);d.bitmap.fontSize=b;var j=b;var n=d.bitmap.measureTextWidth(i);d.bitmap.drawText(i,0,0,k,b,'left');d.x=c.screenX()-n/2;var l=Math.max(c.screenY()-(c._height+j+f+e),j+f+h-e);d.y=l;g.bitmap=new Bitmap(100,10);g.bitmap.fillAll('rgba(0,0,0,0.3)');g.bitmap.gradientFillRect(0,0,100*c._hp/m,10,'rgba(0,255,0,0.3)','rgba(0,100,0,0.3)');g.x=c.screenX()-50;g.y=l+j;if(i==='0'){d.hide();g.hide()}if(a.showHPBar==='true')SceneManager._scene.addChild(g);if(a.showHP==='true')SceneManager._scene.addChild(d)});if(c)requestAnimationFrame(d)},i=function(){c=true;requestAnimationFrame(d)},j=function(){c=false};g.addEventListener('battleStarted',i);;['battleWon','battleEscaped','afterDefeat'].forEach(function(a){g.addEventListener(a,j)})};g.addEventListener('gameObjectsCreated',i)},'1':function(b,c,e,d){var a=b('5');c.exports=function b(b,c){return function(){b.apply(this,a(arguments));d.dispatchEvent(new CustomEvent(c))}}},'2':function(e,d,f,g){var a=function(g,j,i,h,a){var b=1-a,e=a*a*a,d=3*a*a*b,c=3*a*b*b,f=b*b*b;return h*e+i*d+j*c+g*f};var b=function(a,b,c){if(a<b)return b;if(a>c)return c;return a};var c=function(c,i){if(c.length%3!==1)throw new Error('invalid input');for(var d=0;d<c.length-1;d+=3){var e=c[d],g=c[d+1],h=c[d+2],f=c[d+3];if(d===0)e.x=0;else e.x=b(e.x,0,1);if(d===c.length-4)f.x=1;else f.x=b(f.x,e.x,1);g.x=b(g.x,e.x,f.x);h.x=b(h.x,e.x,f.x)}return function(e){var d,j,k,b;for(var f=0;f<c.length-1;f+=3){d=c[f];j=c[f+1];k=c[f+2];b=c[f+3];if(e>=d.x&&e<=b.x)break}var g=0,l=1,h=e,m;if(e<g)return a(d.y,j.y,k.y,b.y,g);if(e>l)return a(d.y,j.y,k.y,b.y,l);while(g<l){m=a(d.x,j.x,k.x,b.x,h);if(Math.abs(m-e)<i)return a(d.y,j.y,k.y,b.y,h);if(e>m)g=h;else l=h;h=(l-g)*.5+g}return a(d.y,j.y,k.y,b.y,h)}};d.exports=c},'3':function(d,e,f,g){var b=d('6');function c(a,b,c,d){if(!a)throw new Error('no duration given');if(!b)throw new Error('no equation given');if(!c)throw new Error('no onStep given');this.duration=a;this.equation=b;this.onStep=c;this.onEnd=d||function(){};this.step=this.step.bind(this)}function a(a){b(a);return function(){this.elapsed=this.duration}}c.prototype={get paused(){return this.cancel==null&&this.elapsed!=null},get active(){return this.cancel!=null},get idle(){return this.cancel==null&&this.elapsed==null},start:function(){if(this.idle){this.elapsed=0;this.cancel=a(this.step)}return this},step:function(c){this.elapsed+=c-(this.time||c);var b=this.elapsed/this.duration;if(b>1)b=1;if(b!==1){this.time=c;this.cancel=a(this.step)}else{this.cancel=this.time=this.elapsed=null;a(this.onEnd)}var d=this.equation(b);this.onStep(d)},stop:function(){if(this.active){this.cancel();this.elapsed=this.cancel=this.time=null}return this},pause:function(){if(this.active){this.cancel();this.cancel=this.time=null}return this},loop:function(){var a=this;a.onEnd=function(){a.start()};a.start();return{cancel:function(){a.onEnd=function(){};a.cancel()}}},resume:function(){if(this.paused){this.cancel=a(this.step)}return this}};e.exports=c},'4':function(b,c,d,e){var a=b('7');c.exports=function(){return PluginManager.parameters(a())}},'5':function(b,a,c,d){a.exports=Function.prototype.call.bind(Array.prototype.slice)},'6':function(c,b,d,a){b.exports=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(a){setTimeout(function(){a(+new Date)},1e3/60)}},'7':function(b,a,c,d){a.exports=function(){return/([^\/]+)\.js$/.exec(document.currentScript.src)[1]}}},this))